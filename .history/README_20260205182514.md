# ğŸ³ Browser Automation with Docker & Puppeteer

Complete setup for running headless Chrome browser automation inside Docker containers.

## ğŸ“‹ Prerequisites

- **Docker Desktop** installed ([Download](https://www.docker.com/products/docker-desktop))
- **Windows**: Docker Desktop for Windows
- **Mac**: Docker Desktop for Mac
- **Linux**: Docker Engine

Verify installation:
```bash
docker --version
```

## ğŸš€ Quick Start

### Windows Users
```bash
run.bat
```

### Mac/Linux Users
```bash
chmod +x run.sh
./run.sh
```

### Manual Steps

**Step 1: Build Docker Image**
```bash
docker build -t browser-automation .
```

**Step 2: Run Container**
```bash
docker run --rm -v "%cd%:/app" browser-automation
```

## ğŸ“ Project Structure

```
sample/
â”œâ”€â”€ script.js           # Puppeteer automation script
â”œâ”€â”€ package.json        # Node.js dependencies
â”œâ”€â”€ Dockerfile          # Docker container definition
â”œâ”€â”€ .dockerignore       # Files to exclude from Docker
â”œâ”€â”€ run.bat             # Windows automation script
â”œâ”€â”€ run.sh              # Mac/Linux automation script
â””â”€â”€ screenshot.png      # Output from the script (generated)
```

## ğŸ” What the Script Does

1. âœ… Launches headless Chrome inside the container
2. âœ… Opens https://example.com
3. âœ… Extracts page title
4. âœ… Extracts all H1 tags
5. âœ… Extracts first 5 links
6. âœ… Takes a screenshot
7. âœ… Closes browser gracefully

## ğŸ“Š Expected Output

```
ğŸš€ Starting browser automation
âœ… Browser launched
âœ… New page created
ğŸ“„ Navigating to https://example.com
ğŸ“‹ Page title: Example Domain
ğŸ”— Page URL: https://example.com/
ğŸ“ H1 tags found: Example Domain
ğŸ”— First 5 links:
   1. More information... -> https://www.iana.org/domains/example
ğŸ“¸ Taking screenshot...
âœ… Screenshot saved as screenshot.png
ğŸ›‘ Browser closed
âœ¨ Automation finished successfully!
```

## âš™ï¸ Configuration

Edit `script.js` to customize:

- **Website URL**: Change `https://example.com`
- **Wait condition**: Modify `waitUntil: "networkidle2"`
- **Selectors**: Update CSS selectors for different elements
- **Actions**: Add clicks, form fills, scrolling, etc.

## ğŸ”’ Security Flags Explanation

```javascript
args: [
  "--no-sandbox",           // Required for Docker
  "--disable-setuid-sandbox", // Required for Docker
  "--disable-dev-shm-usage"  // Prevents /dev/shm full errors
]
```

These are **required** in Docker environments and are safe.

## ğŸ› ï¸ Useful Docker Commands

### Build and tag
```bash
docker build -t browser-automation:latest .
```

### Run with interactive output
```bash
docker run --rm browser-automation
```

### Run and save output
```bash
docker run --rm -v "%cd%:/app" browser-automation > output.log 2>&1
```

### Remove image
```bash
docker rmi browser-automation
```

### View Docker images
```bash
docker images
```

## ğŸ› Troubleshooting

| Problem | Solution |
|---------|----------|
| Docker not found | Install Docker Desktop |
| Browser launch fails | Ensure image is built with Puppeteer deps |
| /dev/shm full error | Add `--disable-dev-shm-usage` flag âœ… |
| Script never exits | Ensure `browser.close()` and `process.exit()` |
| CAPTCHA appears | Website is blocking automation (not Docker issue) |
| Screenshot empty | Increase wait time or check selector |

## ğŸš¢ Advanced: Cloud Deployment

### Google Cloud Run
```bash
docker tag browser-automation gcr.io/PROJECT_ID/browser-automation
docker push gcr.io/PROJECT_ID/browser-automation

gcloud run jobs create automation-job \
  --image=gcr.io/PROJECT_ID/browser-automation \
  --region=us-central1 \
  --memory=2Gi \
  --cpu=2
```

### Cron Scheduling
Edit your system crontab:
```bash
0 8 * * * docker run --rm browser-automation
```
(Runs every day at 8 AM)

## ğŸ“š Learn More

- [Puppeteer Docs](https://pptr.dev/)
- [Docker Docs](https://docs.docker.com/)
- [Official Puppeteer Docker Image](https://github.com/puppeteer/puppeteer/blob/main/docker/Dockerfile)

## ğŸ“ License

MIT
